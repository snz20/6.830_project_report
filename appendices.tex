
\section*{Appendix A: Installing Madlib with PostgreSQL}


These instructions have been tested on Ubuntu 12.04 x64. It won't work with Ubuntu 12.04 x32 (MADlib does not have support for Ubuntu 32-bit). Also, MADlib doesn't work with GCC 4.7.*, so since Ubuntu 12.10 ships with GCC 4.7.2 it might be an issue.

~~\\
\# install postgres packages \\
sudo apt-get -y install postgresql-9.1 libpq-dev postgresql-server-dev-9.1 postgresql-plpython-9.1

\# Download madlib from http://madlib.net and copy tar file to server \\
wget https://github.com/madlib/madlib/zipball/v0.5.0
unzip v0.5.0
cd madlib-madlib-5fabd88 

\# Build Madlib \\
sudo apt-get -y install cmake
sudo apt-get -y install m4 gcc-4.6 g++-4.6 g++
./configure
cd build/
make
make doc
make install

\# To connect to the database: \\
sudo su - postgres
psql

\# To add a password to a role: (note: might be more convenient to use a 1-letter password when coding for MADlib as we'll keep having to enter the password each time we reinstall it) \\
postgres=\# alter role postgres with password 'postgres';

\# To register Madlib with the postgres database \\
/usr/local/madlib/bin/madpack -p postgres -c \$USER@\$HOST/postgres install

\# To test your installation you can run the install check procedure: \\
/usr/local/madlib/bin/madpack -p postgres -c \$USER@\$HOST/\$DATABASE install-check


\section*{Appendix B: Creating a module in Madlib}

Create a new function testpy. We are going to create this section in any module called 'testmod'.

\begin{itemize}
  \item Add new module folder: ./src/ports/postgres/modules/testmod/
  \item Create in this folder the following files:

\begin{itemize}
  \item \_\_init\_\_.py\_in  
  \item testmod.py\_in
  \item testmod.sql\_in
\end{itemize}

\item Modify ./src/config/Modules.yml and add a new line "	- name: testmod"
  \item recompile MADlib: with any user:

\begin{itemize}
  \item ./configure
  \item make install      \# (no need for make clean) (in the MADlib build folder)
\end{itemize}
  \item re-register MADlib into Postgresql (with postgres user):
  \begin{itemize}
  \item  /usr/local/madlib/bin/madpack -p postgres -c \$USER@\$HOST/postgres reinstall
  \end{itemize}
 \end{itemize}
 


\section*{Appendix C: How to use GP module in MADlib}


\section*{Appendix D: How to use AdaBoost module in MADlib}
Currently our implementation supports only binary classification.

\subsection*{Input}
The {\itshape training data} as well as {\itshape test data} is expected to be of the following form:

\begin{verbatim}
TABLE tableName (
    id INTEGER, // 1 indexed
    attribute1 DOUBLE PRECISION,
    ...
    attributeN DOUBLE PRECISION,
    class INTEGER // should be either 1 or -1
)
\end{verbatim}

\subsection*{Usage}
Perform AdaBoost classification loading the whole dataset into memory: (This type of execution is pretty fast when the dataset is small and fits into memory)

\begin{verbatim}
postgres=# SELECT * from madlib.adaboost_train_and_classify (
               'trainingSet', 'testSet', 
               '{attribute1, ..., attributeN}', 
               'class', numberOfIterations, pValue
           );
\end{verbatim}

When the dataset cannot be fit into memory, the user can use either batched or row-by-row version of AdaBoost.
\vspace{\baselineskip}
{\raggedleft Perform row-by-row version of AdaBoost classification:}

\begin{verbatim}
postgres=# SELECT * from madlib.adaboostRow_train_and_classify (
               'trainingSet', 'testSet', 
               '{attribute1, ..., attributeN}', 
               'class', numberOfIterations, pValue
           );
\end{verbatim}

{\raggedleft Perform batched version of AdaBoost classification:}

\begin{verbatim}
postgres=# SELECT * from madlib.adaboostBatch_train_and_classify (
               'trainingSet', 'testSet', 
               '{attribute1, ..., attributeN}', 
               'class', numberOfBatches,
                numberOfIterations, pValue
           );
\end{verbatim}

\subsection*{Example}
This is an over-simplified example of the in-memory execution of AdaBoost classification. Batched and row-by-row versions are similar.
\vspace{\baselineskip}
{\raggedleft The training and test data:}

\begin{verbatim}
postgres=# SELECT * from trainingSet;
 id | attr1 | attr2 | attr3 | class 
----+-------+-------+-------+--------
  1 |    85 |    92 |    45 |     1 
  2 |    85 |    64 |    59 |    -1 
  3 |    86 |    54 |    33 |     1 
  4 |    91 |    78 |    34 |     1 
  5 |    87 |    70 |    12 |    -1 
  6 |    98 |    55 |    13 |     1 
(6 rows)

postgres=# SELECT * from testSet;
 id | attr1 | attr2 | attr3 | class 
----+-------+-------+-------+--------
  1 |    95 |    82 |    15 |    -1 
  2 |    86 |    54 |    54 |     1 
  3 |    88 |    64 |    43 |     1 
  4 |    81 |    70 |    46 |     1 
  5 |    97 |    77 |    10 |    -1 
  6 |    88 |    65 |    12 |    -1 
(6 rows)
\end{verbatim}

{\raggedleft Perform AdaBoost classification:}

\begin{verbatim}
postgres=# SELECT * FROM madlib.adaboost_train_and_classify (
               'trainingSet', 'testSet', 
               '{attr1, attr2, attr3}', 
               'class', 50, 0.05
           );
\end{verbatim}

{\raggedleft The above query produces the following output summary:}

\begin{verbatim}
      result_table_name      
-----------------------------
 adaboost_classifier_weights
 adaboost_classified_samples
 adaboost_confusion_matrix
 adaboost_AUC
(4 rows)
\end{verbatim}

{\raggedleft Check the contents of the above tables to get the classification results:}

\begin{verbatim}
postgres=# SELECT * FROM adaboost_classifier_weights;

 id |     weight      
----+-----------------
 0  | 0.0492970944955
 1  |  0.161430043833
 2  |  0.225351747846
 3  |  0.225351747846
 4  |  0.190980668725
 5  |  0.147588697256
(6 rows)

postgres=# SELECT * FROM adaboost_classified_samples;

 row_id |     score      | predicted_class 
--------+----------------+-----------------
 0      |  12.3265804125 |               1
 1      | -12.2369378612 |              -1
 2      |  11.9033472397 |               1
 3      |  11.9033472397 |               1
 4      |  10.7171405001 |               1
 5      | -12.0688375328 |              -1
(6 rows)

postgres=# SELECT * FROM adaboost_confusion_matrix;

 tp | fp | fn | tn 
----+----+----+----
  2 |  2 |  1 |  1
(1 row)

postgres=# SELECT * FROM adaboost_AUC;

      auc       
----------------
 0.444444444444
(1 row)

\end{verbatim}




